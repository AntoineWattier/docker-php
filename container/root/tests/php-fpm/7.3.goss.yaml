gossfile:
  base.goss.yaml: {}

command:
  # IMPORTANT: confirm the major/minor version of PHP itself
  php -r 'echo PHP_MAJOR_VERSION;':
    exit-status: 0
    stdout: [7]
  php -r 'echo PHP_MINOR_VERSION;':
    exit-status: 0
    stdout: [3]
  php-fpm7.3 -v:
    exit-status: 0
    stdout: [PHP 7.3]
  # Not common to all variants, test in supported children
  php -m | grep -i memcache:
    exit-status: 0

file:
  {{ .Env.CONF_PHPFPM }}:
    contains:
      - '/^log_limit = \${PHP_FPM_LOG_LIMIT}/'
      - '/^log_buffering = yes/'
  {{ .Env.CONF_FPMPOOL }}:
    contains:
      - '/^decorate_workers_output = no/'
